# Config file for automatic testing at travis-ci.org
language: python
python:
  - "3.5"
before_install:
  - unset _JAVA_OPTIONS
  - rvm install 2.2.1
  - nvm install 6.5
cache:
  pip: true
  directories:
  - node_modules
install:
  - bundle install
  - npm install
  - pip install -r requirements/ci.txt
env:
  - DJANGO_SETTINGS_MODULE='project.settings.ci' DELUXE_TEST=1 SECRET_KEY='not so secret key'
addons:
  postgresql: "9.4"
before_script:
  - psql -c 'create database intake;' -U postgres
  - python ./manage.py migrate
  - python ./manage.py load_essential_data
  - python ./manage.py new_fixtures
  - python ./manage.py collectstatic --noinput
script:
  - ./manage.py new_fixtures
  - make test.everything
after_success:
  - codeclimate-test-reporter
